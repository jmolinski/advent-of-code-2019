let required_fuel mass = max ((mass / 3) - 2) 0

let part1 inp = List.fold_left ( + ) 0 (List.map required_fuel inp)

let part2 inp =
  let rec fuel_for_module m =
    let f = required_fuel m in
    if f > 0 then f + fuel_for_module f else f
  in
  List.fold_left ( + ) 0 (List.map fuel_for_module inp)

let main =
  let inp =
    [ 94164
    ; 100562
    ; 114499
    ; 134308
    ; 138764
    ; 114494
    ; 70457
    ; 113793
    ; 117753
    ; 77795
    ; 110371
    ; 113357
    ; 118839
    ; 99757
    ; 119918
    ; 145232
    ; 147113
    ; 142411
    ; 93053
    ; 81783
    ; 124022
    ; 98470
    ; 77368
    ; 75163
    ; 79175
    ; 131174
    ; 93196
    ; 121875
    ; 86016
    ; 148758
    ; 126577
    ; 109812
    ; 105696
    ; 66318
    ; 146939
    ; 113236
    ; 130014
    ; 135719
    ; 127114
    ; 69700
    ; 109416
    ; 64168
    ; 89215
    ; 69015
    ; 128511
    ; 59682
    ; 79067
    ; 58795
    ; 145447
    ; 129419
    ; 93058
    ; 63860
    ; 146148
    ; 58364
    ; 74149
    ; 81871
    ; 116469
    ; 131739
    ; 132852
    ; 148040
    ; 98865
    ; 56588
    ; 79326
    ; 114713
    ; 52397
    ; 134887
    ; 114809
    ; 113356
    ; 60505
    ; 142323
    ; 84792
    ; 117079
    ; 147796
    ; 50196
    ; 148897
    ; 100794
    ; 50508
    ; 71023
    ; 149350
    ; 66679
    ; 93680
    ; 116069
    ; 133042
    ; 117291
    ; 127439
    ; 81598
    ; 93163
    ; 83964
    ; 64226
    ; 63026
    ; 82625
    ; 59589
    ; 94831
    ; 66807
    ; 120375
    ; 112108
    ; 83484
    ; 109892
    ; 66136
    ; 126794 ]
  in
  Printf.printf "Part 1: %d\n" (part1 inp) ;
  Printf.printf "Part 2: %d\n" (part2 inp) ;
  ()
